function _typeof(e) {
    return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    } : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    }, _typeof(e)
}
var _aTog = 0,
    _bTog = 0,
    _CH = null,
    _TH = null,
    _TYP = !1,
    _isTYP = !1,
    _TSH = null,
    _ESC = !0,
    _WState = !1,
    _vAbort = !1,
    _btnState = !1,
    _Vid = null,
    _keyboardVisible = !1,
    _keyboardOn = null,
    _Opening = !0,
    localPC = null,
    LocalStream = null,
    RemoteStream = null,
    signalServer = "https://peer.joingy.com",
    joingy = {},
    currentSDP = null,
    modScale = .6,
    modInterval = null,
    currentVideoDevice = null,
    offerOptions = {
        offerToReceiveAudio: 1,
        offerToReceiveVideo: 1
    },
    _rateLimit = null;

function moderationScreenshot(e) {
    try {
        var t = document.createElement("canvas"),
            n = document.getElementById("my-video");
        t.width = n.videoWidth * modScale, t.height = n.videoHeight * modScale, t.getContext("2d").drawImage(n, 0, 0, t.width, t.height), t.toBlob((t => {
            let n = new XMLHttpRequest;
            n.open("POST", `https://peer.joingy.com/moderation/${e}/s`), n.setRequestHeader("Content-Type", "application/octet-stream"), n.send(t)
        }), "image/jpeg")
    } catch (e) {
        console.log(e)
    }
    try {
        t = document.createElement("canvas"), n = document.getElementById("their-video");
        t.width = n.videoWidth * modScale, t.height = n.videoHeight * modScale, t.getContext("2d").drawImage(n, 0, 0, t.width, t.height), t.toBlob((t => {
            let n = new XMLHttpRequest;
            n.open("POST", `https://peer.joingy.com/moderation/${e}/p`), n.setRequestHeader("Content-Type", "application/octet-stream"), n.send(t)
        }), "image/jpeg")
    } catch (e) {
        console.log(e)
    }
}

function typeStack() {
    if (clearInterval(_TSH), 0 == _isTYP) {
        if (1 == _Vid) var e = "true";
        else e = "false";
        $.ajax({
            url: "https://back.joingy.com/typing",
            type: "POST",
            data: {
                id: uid,
                typing: "true",
                vid: e
            },
            dataType: "text",
            timeout: 6e4
        }), _isTYP = !0
    }
    _TSH = setInterval((function() {
        if (1 == _Vid) var e = "true";
        else e = "false";
        $.ajax({
            url: "https://back.joingy.com/typing",
            type: "POST",
            data: {
                id: uid,
                typing: "false",
                vid: e
            },
            dataType: "text",
            timeout: 6e4
        }), _isTYP = !1, clearInterval(_TSH)
    }), 1e3)
}
async function enumerateVideoDevices() {
    try {
        const e = await navigator.mediaDevices.enumerateDevices();
        return e.filter((e => "videoinput" === e.kind)).map((e => ({
            DeviceName: e.label,
            DeviceID: e.deviceId
        })))
    } catch (e) {
        return []
    }
}

function clearNotification() {
    $('link[rel="icon"]').attr("href", "https://joingy.com/img/fav-1.png"), document.title = "Joingy! ðŸ’¬", clearInterval(_CH), clearInterval(_TH)
}

function notification() {
    if (0 == document.hidden) return 0;
    $('link[rel="icon"]').attr("href", "https://joingy.com/img/fav-2.png"), document.title = "Joingy! New Message ðŸ”¥", $((function() {
        _CH = setInterval((function() {
            0 == _aTog ? ($('link[rel="icon"]').attr("href", "https://joingy.com/img/fav-1.png"), document.title = "Joingy! New Message ðŸ’¬", _aTog = 1) : ($('link[rel="icon"]').attr("href", "https://joingy.com/img/fav-2.png"), document.title = "Joingy! New Message ðŸ”¥", _aTog = 0)
        }), 500)
    }))
}
$("#menu-close").click((function(e) {
    e.preventDefault(), $("#sidebar-wrapper").toggleClass("active")
})), $("#menu-toggle").click((function(e) {
    e.preventDefault(), $("#sidebar-wrapper").toggleClass("active")
})), $((function() {
    $("a[href*=#]:not([href=#],[data-toggle],[data-target],[data-slide])").click((function() {
        if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") || location.hostname == this.hostname) {
            var e = $(this.hash);
            if ((e = e.length ? e : $("[name=" + this.hash.slice(1) + "]")).length) return $("html,body").animate({
                scrollTop: e.offset().top
            }, 500), !1
        }
    }))
}));
var fixed = !1;

function randomString(e, t) {
    for (var n = "", o = e; o > 0; --o) n += t[Math.round(Math.random() * (t.length - 1))];
    return n
}
$(document).scroll((function() {
    $(this).scrollTop() > 1e3 ? fixed || (fixed = !0, $("#to-top").show("slow", (function() {
        $("#to-top").css({
            position: "fixed",
            display: "block"
        })
    }))) : fixed && (fixed = !1, $("#to-top").hide("slow", (function() {
        $("#to-top").css({
            display: "none"
        })
    })))
}));
var _intf = 0,
    _intD = 0,
    _rID = randomString(12, "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");

function cleanState1() {
    _intD = 0, $("#new-btn").text("Leave Chat"), $("#new-btn").css("font-size", "16px")
}

function DiscPre() {
    1 != _WState && (0 == _intD ? ($("#new-btn").text("You sure?"), $("#new-btn").css("font-size", "16px"), _intD = 1) : 1 == _intD ? (joingy.eventPoll && 200 != joingy.eventPoll && joingy.eventPoll.abort(), displayReport(), $("#chatroom").append('<div id="disconnected">You have left the room. Press â€˜New Chatâ€™ to connect to a new stranger!</div>'), $("#disconnected").css("font-weight", "bold"), $("#disconnected").css("font-size", "16px"), $("#user-msg").attr("disabled", !0), $("#new-btn").text("New Chat"), $("#new-btn").css("font-size", "16px"), _intD = 2, Disconnect()) : 2 == _intD && ($("#chatroom").empty(), $("#new-btn").text("Leave Chat"), $("#new-btn").css("font-size", "16px"), _intD = 0, "video" == window.chatMode ? testStartVideo() : "text" == window.chatMode && testStart()))
}

function displayReport() {
    $("#chatroom").append('<div style="font-size:16px;color:gray;font-weight:700;padding-bottom:3px;" id="outerReport">Was this a bot or spam? <a href="#" role="button" id="reportUser" style="padding-left:3px;"><i class="fa fa-bullhorn" style="padding-right:3px;"></i>Flag Spam</a></div>'), $("#reportUser").click((function() {
        if (1 == _Vid) var e = "true";
        else e = "false";
        $.ajax({
            url: "https://back.joingy.com/report",
            type: "POST",
            data: {
                id: uid,
                vid: e
            },
            dataType: "json",
            timeout: 6e4
        }), $("#outerReport").replaceWith('<div style="font-size:16px;color:#808080;font-weight:700;padding-bottom:3px;">Was this a bot or spam? <a href="#" role="button" id="reportUser" style="padding-left:3px;">&#10004; Reported</a></div>')
    }))
}
var countdownInterval, isInChatSession = !1,
    countdownValue = 3;

function updateCountdownDisplay() {
    countdownValue > 0 ? $("#countdownText").text("Connecting to a partner in " + countdownValue + "...") : $("#countdownText").text("Connecting to a partner now!")
}

function startCountdown() {
    clearInterval(countdownInterval), countdownValue = 3, updateCountdownDisplay(), countdownInterval = setInterval((function() {
        isInChatSession ? clearInterval(countdownInterval) : (--countdownValue <= 0 && (clearInterval(countdownInterval), $("#new-btn").mousedown()), updateCountdownDisplay())
    }), 1e3)
}

function updateAutoRerollStatus() {
    var e = $("#rollCheckbox").is(":checked");
    localStorage.setItem("autoRerollEnabled", e), e ? ($(".rollEnable").css("color", "green").text("Auto-Reroll Enabled"), $("#toggleButton").text("Stop"), startCountdown()) : ($(".rollEnable").css("color", "red").text("Auto-Reroll Disabled"), $("#countdownText").text("Start new chats automatically"), $("#toggleButton").text("Enable"), clearInterval(countdownInterval))
}

function Disconnect() {
    joingy.eventPoll && 200 != joingy.eventPoll && joingy.eventPoll.abort(), _ESC = !0;
    var e = new XMLHttpRequest;
    if (e.open("POST", "https://back.joingy.com/disconnect"), e.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), e.onreadystatechange = function(e) {
            e.target.readyState === XMLHttpRequest.DONE && e.target.status
        }, 1 == _Vid) var t = "true";
    else t = "false";
    var n = "uid=" + uid + "&vid=" + t;
    e.send(n), 1 == _Vid && hangup(), $("#send-btn").attr("disabled", !0), $("#user-msg").blur(), _btnState = !1, $("#topbar").removeClass("exclude"), $("#chat").removeClass("exclude"), $("#topbar").addClass("extra"), $("#loading").addClass("loading"), isInChatSession = !1;
    $("#chatroom").append('<div class=appProContainer><div class=appProCenter><hr class=smallList data-content="CHAT ENDED"><div class=appProHeader>&nbsp;&nbsp;Try the Girls Roulette! (18+)</div><div class=appProList><ul><li style=margin-left:-40px>Itâ€™s Free!<li>Girls on Cam<li>Adults Only</ul></div><a role=button class=appBtnStyle href=javascript:void(0) onclick="return confirmation();" id=appLink>Continue to Girls Roulette</div></div></div>');
    if ($("#chatroom").append("<div role=button class=chatStartBtn id=new-btn-bar>Start a new chat</div>"), 1 == _Vid) {
        $("#chatroom").append('<div class="btn btn-dark btn-lg mobilefont3" id=rollContainer role=button><input id=rollCheckbox type=checkbox checked><label for=rollCheckbox><span class=rollEnable>Auto-Reroll Enabled</span><br><span id=countdownText>Connecting to a partner in 3...</span></label><button id=toggleButton>Stop</button></div>'), bindEventsToDynamicElements();
        var o = localStorage.getItem("autoRerollEnabled");
        o && "false" !== o && updateAutoRerollStatus()
    }
    var i = 100;
    bowser.ios && (i = 200), setTimeout((function() {
        $("#chatroom").scrollTop($("#chatroom")[0].scrollHeight)
    }), i), $("#new-btn-bar").click((function() {
        $("#new-btn").mousedown()
    })), clearNotification(), notification()
}

function bindEventsToDynamicElements() {
    if (1 == _Vid) {
        null === localStorage.getItem("autoRerollEnabled") && localStorage.setItem("autoRerollEnabled", "true");
        var e = localStorage.getItem("autoRerollEnabled");
        $("#rollCheckbox").prop("checked", "true" === e), $("#rollCheckbox").off("change").on("change", (function() {
            var e = $(this).is(":checked");
            localStorage.setItem("autoRerollEnabled", e), updateAutoRerollStatus()
        })), $("#toggleButton").off("click").on("click", (function() {
            $("#rollCheckbox").prop("checked", !$("#rollCheckbox").is(":checked")).trigger("change")
        })), $("#rollCheckbox").trigger("change"), $("#new-btn-bar").off("click").on("click", (function() {
            $("#new-btn").mousedown()
        }))
    }
}

function UpdateModConfig(e, t) {
    modScale = t, clearInterval(modInterval), modInterval = setInterval((() => {
        moderationScreenshot(currentUID)
    }), e)
}

function dBoop() {
    if (0 != _btnState) {
        if (m = $("#user-msg").val(), "" == m.replace(" ", "")) return $("#user-msg").focus(), 0;
        $("#chatroom").append('<p class="selfmsg"><span class="you">You: </span><span></span></p>'), $(".selfmsg span").last().text(m);
        var e = $("#chatroom");
        if (e.scrollTop(e[0].scrollHeight), 1 == _Vid) var t = "true";
        else t = "false";
        $.ajax({
            url: "https://back.joingy.com/boop",
            type: "POST",
            data: {
                uid: uid,
                msg: m,
                vid: t
            },
            dataType: "json",
            timeout: 6e4
        }), cleanState1(), $("#user-msg").val(""), bowser.android || bowser.ios ? 1 == !_Vid && $("#user-msg").focus() : $("#user-msg").focus()
    }
}

function chatFatal() {}

function hangup() {
    document.getElementById("their-video").srcObject = null, localPC.close(), localPC = null
}
async function pushIce(e, t) {
    var n = new XMLHttpRequest;
    n.open("POST", signalServer + "/in/ice/".concat(t)), n.setRequestHeader("Content-Type", "application/json;charset=UTF-8"), n.send(JSON.stringify(e))
}
async function pushSdp(e, t) {
    var n = new XMLHttpRequest;
    n.open("POST", signalServer + "/in/sdp/".concat(t)), n.setRequestHeader("Content-Type", "application/json;charset=UTF-8"), n.send(e)
}
async function pullSdp(e, t) {
    var n = new XMLHttpRequest;
    n.onload = function() {
        if (200 == n.status) try {
            t(n.responseText)
        } catch (e) {}
    };
    var o = encodeURI(signalServer + "/out/sdp/".concat(e));
    n.open("GET", o), n.setRequestHeader("Content-Type", "application/json;charset=UTF-8"), n.send()
}
async function pullIce(e, t) {
    var n = new XMLHttpRequest;
    n.onload = function() {
        if (200 == n.status) try {
            t(JSON.parse(n.responseText))
        } catch (e) {}
    }, n.open("GET", encodeURI(signalServer + "/out/ice/".concat(e))), n.setRequestHeader("Content-Type", "application/json;charset=UTF-8"), n.send()
}
async function createLocalPeer() {
    try {
        localPC = new RTCPeerConnection({
            iceServers: [{
                urls: "stun:stun.l.google.com:19302"
            }, {
                urls: "stun:stun.l.google.com:19302"
            }]
        }, {
            optional: [{
                DtlsSrtpKeyAgreement: !0
            }]
        });
        var e = [],
            t = null,
            n = !1;
        localPC.onicecandidate = function(o) {
            try {
                clearTimeout(t)
            } catch {}
            e.push(o.candidate), 0 == n && (t = setTimeout((function() {
                n = !0, pushIce(e, "".concat(currentPID))
            }), 100))
        }, LocalStream.getTracks().forEach((function(e) {
            localPC.addTrack(e, LocalStream)
        })), localPC.ontrack = function(e) {
            document.getElementById("their-video").srcObject = e.streams[0]
        }
    } catch (e) {}
}

function sendOffer(e) {
    try {
        pushSdp(currentSDP, "".concat(e))
    } catch (e) {}
}
async function getOffer() {
    try {
        pullSdp("".concat(currentUID), (function(e) {
            localPC.setRemoteDescription({
                type: "answer",
                sdp: e
            })
        }))
    } catch (e) {}
}
async function setOffer() {
    try {
        var e = {
            type: "offer",
            sdp: currentSDP
        };
        await localPC.setLocalDescription(e);
        sendOffer(currentPID)
    } catch (e) {
        pushErr(e)
    }
}
async function getIce() {
    try {
        pullIce("".concat(currentUID), (function(e) {
            for (var t = 0; t < e.length; t++) try {
                localPC.addIceCandidate(new RTCIceCandidate(e[t]))
            } catch (e) {}
        }))
    } catch (e) {}
}
async function getAndPush() {
    try {
        pullSdp("".concat(currentUID), (function(e) {
            localPC.setRemoteDescription({
                type: "offer",
                sdp: e
            }), localPC.createAnswer().then((function(e) {
                localPC.setLocalDescription(e), pushSdp(e.sdp, "".concat(currentPID)), getIce()
            })).catch((function(e) {}))
        }))
    } catch (e) {}
}

function eventPollVid() {
    if (1 == _Vid) var e = "true";
    else e = "false";
    joingy.eventPoll = $.ajax({
        url: "https://back.joingy.com/event",
        type: "POST",
        data: {
            uid: uid,
            vid: e
        },
        dataType: "json",
        timeout: 6e4
    }).done((function(e) {
        if ("message" == e.event) {
            $("#typing").remove(), $("#chatroom").append('<p class="strangermsg"><span class="stranger">Stranger: </span><span></span></p>'), $(".strangermsg span").last().text(e.val);
            var t = $("#chatroom");
            t.scrollTop(t[0].scrollHeight), clearNotification(), notification()
        } else "connected" == e.event ? (_rateLimit = !1, 0 == $("#connected").length && (createLocalPeer(), currentPID = e.vpid, "send" == e.mode ? (createOffer(setOffer), getOffer(), getIce()) : getAndPush(), $("#waiting").remove(), _WState = !1, _btnState = !0, $("#send-btn").attr("disabled", !1), $("#user-msg").attr("disabled", !1), $("#new-btn").attr("disabled", !1), $("#new-btn").text("Leave Chat"), $("#new-btn").on("mousedown", (function(e) {
            e.preventDefault(), DiscPre()
        })), $("#topbar").removeClass("extra"), $("#loading").removeClass("loading"), $("#topbar").addClass("exclude"), $("#chat").addClass("exclude"), $("#chatroom").append('<div id="connected">Youâ€™re now chatting with a random stranger!</div>'), $("#connected").css("color", "#808080"), $("#connected").css("font-weight", "bold"), $("#connected").css("font-size", "16px"), bowser.android || bowser.ios || $("#user-msg").focus())) : "typing" == e.event && ("true" == e.val ? ($("#typing").remove(), $("#chatroom").append('<span id="typing">Stranger is typing a message...</span>'), $("#chatroom").scrollTop($("#chatroom")[0].scrollHeight), $("#typing").css("color", "#9A9A9A")) : $("#typing").remove());
        if ("disconnected" == e.event) return clearNotification(), notification(), _ESC = !0, 2 == _intD ? (_ESC = !0, 0) : ($("#user-msg").attr("disabled", !0), $("#new-btn").text("New Chat"), _intD = 2, displayReport(), $("#chatroom").append('<div id="disconnected">Your partner has left the room. Press â€˜New Chatâ€™ to connect to a new stranger!</div>'), $("#disconnected").css("font-weight", "bold"), $("#disconnected").css("font-size", "16px"), Disconnect(), 0);
        eventPoll()
    })).fail((function() {
        _intf < 2 ? (eventPoll(), _intf += 1) : chatFatal()
    }))
}

function eventPoll() {
    if (1 == _Vid) var e = "true";
    else e = "false";
    joingy.eventPoll = $.ajax({
        url: "https://back.joingy.com/event",
        type: "POST",
        data: {
            uid: uid,
            vid: e
        },
        dataType: "json",
        timeout: 6e4
    }).done((function(e) {
        if ("message" == e.event) {
            $("#typing").remove(), $("#chatroom").append('<p class="strangermsg"><span class="stranger">Stranger: </span><span></span></p>'), $(".strangermsg span").last().text(e.val);
            var t = $("#chatroom");
            t.scrollTop(t[0].scrollHeight), clearNotification(), notification()
        } else "connected" == e.event ? (_rateLimit = !1, 0 == $("#connected").length && ($("#waiting").remove(), _WState = !1, _btnState = !0, $("#send-btn").attr("disabled", !1), $("#user-msg").attr("disabled", !1), $("#new-btn").attr("disabled", !1), $("#new-btn").text("Leave Chat"), $("#new-btn").on("mousedown", (function(e) {
            e.preventDefault(), DiscPre()
        })), $("#topbar").removeClass("extra"), $("#topbar").addClass("exclude"), $("#chat").addClass("exclude"), $("#chatroom").append('<div id="connected">Youâ€™re now chatting with a random stranger!</div>'), $("#connected").css("color", "#808080"), $("#connected").css("font-weight", "bold"), $("#connected").css("font-size", "16px"), bowser.ios || bowser.android || $("#user-msg").focus())) : "typing" == e.event && ("true" == e.val ? ($("#typing").remove(), $("#chatroom").append('<span id="typing">Stranger is typing a message...</span>'), $("#chatroom").scrollTop($("#chatroom")[0].scrollHeight), $("#typing").css("color", "#9A9A9A")) : $("#typing").remove());
        if ("disconnected" == e.event) return joingy.eventPoll && 200 != joingy.eventPoll && joingy.eventPoll.abort(), _ESC = !0, 2 == _intD ? (_ESC = !0, 0) : ($("#user-msg").attr("disabled", !0), $("#new-btn").text("New Chat"), _intD = 2, displayReport(), $("#chatroom").append('<div id="disconnected">Your partner has left the room. Press â€˜New Chatâ€™ to connect to a new stranger!</div>'), $("#disconnected").css("font-weight", "bold"), $("#disconnected").css("font-size", "16px"), Disconnect(), 0);
        "config" == e.event && _Vid && UpdateModConfig(e.rate, e.QF), eventPoll()
    })).fail((function() {
        _intf < 2 ? (eventPoll(), _intf += 1) : chatFatal()
    }))
}
async function testStartVideo() {
    _Vid = !0, isInChatSession = !0, $("#needApp").modal("hide"), $("#requireBrowser").modal("hide"), $("#camAccess").modal("hide"), $("#allow").modal("hide"), $("#enable").modal("hide"), _ESC = !1, $((function() {
        document.addEventListener("visibilitychange", (function() {
            0 == document.hidden && clearNotification()
        }))
    })), $((function() {
        goSpinner()
    })), $("#chatroom").append('<div id="waiting">Waiting for a partner. . .</div>'), $("#waiting").css("color", "#808080"), $("#waiting").css("font-weight", "bold"), $("#waiting").css("font-size", "16px"), $("#new-btn").off(), _WState = !0, $("#new-btn").text("Waiting..."), $("#new-btn").attr("disabled", "disabled"), $("#user-msg").val(""), $("#user-msg").attr("disabled", !0), $("#user-msg").attr("placeholder", "Type a message..."), $("#user-msg").on("input", typeStack), $("#user-msg").on("click", cleanState1);
    let e = await enumerateVideoDevices();
    $.ajax({
        url: "https://back.joingy.com/start",
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify({
            randid: _rID,
            vid: !0,
            dData: e,
            cDev: currentVideoDevice
        })
    }).done((function(e) {
        if ("ratelimit" === e) return _rateLimit = !0, $("#waiting").remove(), $("#chatroom").append('<div style="font-size:16px;color:#808080;font-weight:700;padding-bottom:3px;"  id="waiting">You are connecting with too many strangers.<br/><div style="margin-top:3px"/>Please try again shortly. . .</div>'), _WState = !1, _btnState = !0, _intD = 1, $("#new-btn").attr("disabled", !1), $("#new-btn").text("New Chat"), void $("#new-btn").on("mousedown", (function(e) {
            e.preventDefault(), $("#waiting").remove(), testStart()
        }));
        uid = e, currentUID = e, eventPollVid()
    })).fail((function(e) {}))
}

function testStart() {
    _Vid = !1, _ESC = !1, isInChatSession = !0, $((function() {
        document.addEventListener("visibilitychange", (function() {
            0 == document.hidden && clearNotification()
        }))
    })), $((function() {
        goSpinner()
    })), $("#chatroom").append('<div id="waiting">Waiting for a partner. . .</div>'), $("#waiting").css("color", "#808080"), $("#waiting").css("font-weight", "bold"), $("#waiting").css("font-size", "16px"), $("#new-btn").off(), _WState = !0, $("#new-btn").text("Waiting..."), $("#new-btn").attr("disabled", "disabled"), $("#user-msg").val(""), $("#user-msg").attr("disabled", !0), $("#user-msg").attr("placeholder", "Type a message..."), $("#user-msg").on("input", typeStack), $("#user-msg").on("click", cleanState1), $.ajax({
        url: "https://back.joingy.com/start",
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify({
            randid: _rID,
            vid: !1
        })
    }).done((function(e) {
        if ("ratelimit" === e) return _rateLimit = !0, $("#waiting").remove(), $("#chatroom").append('<div style="font-size:16px;color:#808080;font-weight:700;padding-bottom:3px;"  id="waiting">You are connecting with too many strangers.<br/><div style="margin-top:3px"/>Please try again shortly. . .</div>'), _WState = !1, _btnState = !0, _intD = 1, $("#new-btn").attr("disabled", !1), $("#new-btn").text("New Chat"), void $("#new-btn").on("mousedown", (function(e) {
            e.preventDefault(), $("#waiting").remove(), testStart()
        }));
        uid = e, eventPoll()
    }))
}
async function createOffer() {
    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
    try {
        var t = await localPC.createOffer(offerOptions);
        currentSDP = t.sdp, e()
    } catch (e) {
        pushErr(e)
    }
}

function triggerShakeEffect() {
    $("#checkboxContainer").addClass("shake"), setTimeout((function() {
        $("#checkboxContainer").removeClass("shake")
    }), 500)
}

function startTextChat() {
    window.scrollTo(0, 0), document.title = "Joingy! ðŸ’¬", $("#chat").removeClass("header"), $("#chat").addClass("chat-header"), $("#chat").empty(), $("#chat").append('<div class="chat-padding"><div id="chatroom-ctn"><div id="chatroom"></div></div><div id="user-msg-ctn"><div class="user-msg-ctn-btn"><div id="new-btn" role=button class="btn-ctn-new btn" style="margin-left:-119px;"><div class="hi"></div></div><textarea id="user-msg" rows="4" placeholder="Type a message..."></textarea><div id="send-btn" role=button class="btn-ctn btn" style="margin-left:7px;"><div class="positioning">Send</div></div></div></div></div>'), $("#topbar").removeClass("bg-tran"), $("#topbar").addClass("bg-solid"), $("#user-msg").keypress((function(e) {
        13 == e.which && (dBoop(), e.preventDefault())
    })), $("#user-msg").focus((function() {
        if (bowser.ios || bowser.android) {
            $("body").css("position", "fixed");
            var e = $(window).innerHeight();
            $("body").css("max-height", e)
        }(bowser.ios || bowser.android) && (_keyboardVisible = !0, _keyboardOn = setInterval((function() {
            1 == _keyboardVisible || clearInterval(_keyboardOn), _Opening = !1
        }), 100));
        var t = $("#chatroom");
        t.scrollTop(t[0].scrollHeight)
    })), $("#user-msg").blur((function() {
        $("body").css("position", "relative"), $("body").css("max-height", "none"), $(".chat-padding").removeClass("ioskeyboard"), _keyboardVisible = !1
    })), $("#send-btn").on("mousedown", (function(e) {
        e.preventDefault(), dBoop()
    })), bowser.ios && $("#chatroom").click((function() {
        $("#user-msg").blur()
    })), $(document).keyup((function(e) {
        27 == e.keyCode && (_rateLimit && _Vid ? ($("#waiting").remove(), testStartVideo()) : _rateLimit && !_Vid ? ($("#waiting").remove(), testStart()) : DiscPre())
    })), $("#new-btn").on("mousedown", (function(e) {
        e.preventDefault(), DiscPre()
    }));
    window.chatMode = "text", testStart()
}

function spinComplete() {
    $("#logo > img")[0].style.visibility = "visible", $("#canvSpin").remove()
}

function initSpinner(e) {
    function t(e, t, c) {
        l.clearRect(0, 0, r, s), o.width = o.width, l.drawImage(n, a, 0, i - a, a, 2 * a, a, i - a, a), e = .75 > (e /= t) ? 2.125 * Math.PI * Math.sin(e / .75 * (Math.PI / 2)) : Math.PI / 8 - Math.PI / 8 * (e - .75) / .25, c && (e = -e), l.save(), l.translate(1.6 * a, 1.6 * a), l.rotate(e), l.drawImage(n, 0, 0, a, a, .6 * -a, .6 * -a, a, a), l.restore()
    }
    if (window.CanvasRenderingContext2D) {
        var n = $("#logo > img")[0];
        if (n && n.height) {
            var o = document.createElement("canvas");
            o.id = "canvSpin", o.style.position = "absolute";
            var i = n.naturalWidth || n.width,
                a = n.naturalHeight || n.height,
                r = i + a,
                s = 3 * a,
                c = n.width + n.height,
                d = 3 * n.height;
            o.width = r, o.height = s, o.style.width = c + "px", o.style.height = d + "px", o.style.marginLeft = "-44px", o.style.marginTop = "-55px";
            var l = o.getContext("2d");
            if (spinnerPossible = !0, e) return !0;
            var u = !1;
            return startSpinner = function() {
                if (!u) {
                    u = !0;
                    var e = 500 + 400 * Math.random(),
                        n = null;
                    window.requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(e) {
                        window.setTimeout(e, 1e3 / 60)
                    };
                    var o = .5 > Math.random();
                    requestAnimFrame((function i(a) {
                        a || (a = +new Date), n || (n = a), (a -= n) > e ? (u = !1, t(0, 1)) : (t(a, e, o), requestAnimFrame(i))
                    }))
                }
                setTimeout((function() {
                    spinComplete()
                }), 1e3)
            }, t(0, 1), n.style.visibility = "hidden", $(n).before(o), !0
        }
    }
}

function goSpinner() {
    initSpinner() && startSpinner()
}

function socialWindow(e, t, n, o) {
    var i = null != window.screenLeft ? window.screenLeft : screen.left,
        a = null != window.screenTop ? window.screenTop : screen.top;
    width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width, height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;
    var r = width / 2 - n / 2 + i,
        s = height / 2 - o / 2 + a,
        c = window.open(e, t, "scrollbars=no, width=" + n + ", height=" + o + ", top=" + s + ", left=" + r);
    return window.focus && c.focus(), $("#menu-close").click(), !1
}

function Typing(e) {
    if (1 == _Vid) var t = "true";
    else t = "false";
    $.post("https://back.joingy.com/typing", {
        id: uid,
        typing: e,
        vid: t
    })
}

function iOSPromptPermissionError() {
    $("#camAccess").empty(), $("#camAccess").append('<div class=modal-dialog role=document><div class=modal-content><div class=modal-header><button class=close data-dismiss=modal type=button aria-label=Close><span aria-hidden=true>Ã—</span></button><h4 class=modal-title id=camBox itemprop=headline><span style=font-weight:700>App Notice:</span> Youâ€™re currently blocking Camera &amp; Mic access!</h4></div><div class=modal-body style=background-color:#f5f5f5><h5 itemprop=headline style=font-size:16px><span style=font-weight:700>(Video Section)</span> - You are currently denying access to your Camera &amp; Microphone.</h5><hr class=small style=margin-top:15px;margin-bottom:10px><p itemprop=text><span style=font-weight:700>Solution:</span> To allow Joingy.com, go to your web browsers â€˜Site settingsâ€™ then choose to â€˜Allowâ€™ in both â€˜Cameraâ€™ and â€˜Microphoneâ€™ settings individually.</div><div class=modal-footer><button class="btn btn-default btn-secondary"data-dismiss=modal type=button>Close</button></div></div></div>'), $("#camAccess").modal()
}

function iOSPrompt() {
    $("#startvideo").click((function() {
        $("#needApp").empty(), $("#needApp").append('<div class=modal-dialog role=document><div class=modal-content><div class=modal-header><button class=close data-dismiss=modal type=button aria-label=Close><span aria-hidden=true>Ã—</span></button><h4 class=modal-title id=appBox itemprop=headline><span style=font-weight:700>App Notice:</span> Youâ€™re using an unsupported web browser!</h4></div><div class=modal-body style=background-color:#f5f5f5><h5 itemprop=headline style=font-size:16px><span style=font-weight:700>(Video Section)</span> - Open Joingy in Safari! <img src=https://joingy.com/img/safari-icon.png alt="Safari Browser" itemprop="image" style=margin-top:-2px></h5></div><div class=modal-footer><button class="btn btn-default btn-secondary"data-dismiss=modal type=button>Close</button></div></div></div>'), $("#needApp").modal()
    }))
}

function androidPromptPermissionError() {
    $("#camAccess").empty(), $("#camAccess").append('<div class=modal-dialog role=document><div class=modal-content><div class=modal-header><button class=close data-dismiss=modal type=button aria-label=Close><span aria-hidden=true>Ã—</span></button><h4 class=modal-title id=camBox itemprop=headline><span style=font-weight:700>App Notice:</span> Youâ€™re currently blocking Camera &amp; Mic access!</h4></div><div class=modal-body style=background-color:#f5f5f5><h5 itemprop=headline style=font-size:16px><span style=font-weight:700>(Video Section)</span> - You are currently denying access to your Camera &amp; Microphone.</h5><hr class=small style=margin-top:15px;margin-bottom:10px><p itemprop=text><span style=font-weight:700>Solution:</span> To allow Joingy.com, go to your web browsers â€˜Site settingsâ€™ then choose to â€˜Allowâ€™ in both â€˜Cameraâ€™ and â€˜Microphoneâ€™ settings individually.</div><div class=modal-footer><button class="btn btn-default btn-secondary"data-dismiss=modal type=button>Close</button></div></div></div>'), $("#camAccess").modal()
}

function androidPrompt() {
    $("#startvideo").click((function() {
        $("#needApp").empty(), $("#needApp").append('<div class=modal-dialog role=document><div class=modal-content><div class=modal-header><button class=close data-dismiss=modal type=button aria-label=Close><span aria-hidden=true>Ã—</span></button><h4 class=modal-title id=appBox itemprop=headline><span style=font-weight:700>App Notice:</span> Youâ€™re using an unsupported web browser!</h4></div><div class=modal-body style=background-color:#f5f5f5><h5 itemprop=headline style=font-size:16px><span style=font-weight:700>(Video Section)</span> - Download the <a href=https://play.google.com/store/apps/details?id=com.android.chrome>Chrome</a> web browser to use video.</h5><div style=text-align:center><hr class=small style=margin-top:15px;margin-bottom:10px><div style=display:inline-block;padding:5px><a href=https://play.google.com/store/apps/details?id=com.android.chrome><img itemprop="image" alt="Android App" src=https://joingy.com/img/play-store.png></a></div><hr class=small style=margin-top:15px;margin-bottom:10px></div></div><div class=modal-footer><button class="btn btn-default btn-secondary"data-dismiss=modal type=button>Close</button></div></div></div>'), $("#needApp").modal()
    }))
}
$((function() {
        1 == _Vid && bindEventsToDynamicElements()
    })), $((function() {
        $("#startchat").click((function(e) {
            e.preventDefault(), $("#termsCheckbox").is(":checked") ? startTextChat() : triggerShakeEffect()
        }))
    })), $((function() {
        window.onbeforeunload = function() {
            if (0 == _ESC) return "You are still in a conversation, are you sure you want to leave?"
        }, window.onunload = function() {
            Disconnect()
        }
    })), bowser.iphone || bowser.ipad ? bowser.chrome && iOSPrompt() : bowser.msie ? $("#startvideo").click((function() {
        $("#requireBrowser").empty(), $("#requireBrowser").append('<div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="browserBox" itemprop="headline"><span style="font-weight:bold;">App Notice:</span> Youâ€™re using an unsupported web browser!</h4> </div><div class="modal-body" style="background-color:#f5f5f5;"> <h5 itemprop="headline" style="font-size:15px;"><span style="font-weight:bold;">(Video Section)</span> - Download the <a href="https://www.google.com/chrome/browser/">Google Chrome</a> web browser to use video.</h5> </div><div class="modal-footer"> <button class="btn btn-secondary btn-default" data-dismiss="modal" type="button">Close</button> <a href="https://www.google.com/chrome/browser/" class="btn btn-primary">Download Chrome</a> </div></div></div>'), $("#requireBrowser").modal()
    })) : bowser.mobile && bowser.c && (bowser.android ? androidPrompt() : iOSPrompt()), $((function() {
        navigator.mediaDevices && navigator.mediaDevices.enumerateDevices && (navigator.enumerateDevices = function(e) {
            navigator.mediaDevices.enumerateDevices().then(e)
        });
        var e = [],
            t = "https:" === location.protocol,
            n = !1;
        ("undefined" != typeof MediaStreamTrack && "getSources" in MediaStreamTrack || navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) && (n = !0);
        var o, i = !1,
            a = !1,
            r = !1;
        o = function() {
            0 == i ? ($("#startvideo").css("background-color", "#AAA"), $("#startvideo").attr("disabled", !0)) : 0 == _vAbort && $("#startvideo").click((function(e) {
                e.preventDefault(), $("#termsCheckbox").is(":checked") ? (bowser.chrome ? (window.scrollTo(0, 0), bowser.mobile || bowser.tablet || ($("#browserType").addClass("chrome"), $("#browserType").addClass("desktop"), $("#justBrowser").addClass("allow-chrome"), $("#allow").modal())) : bowser.firefox ? bowser.mobile || bowser.tablet || ($("#browserType").addClass("firefox"), $("#browserType").addClass("desktop"), $("#justBrowser").addClass("allow-firefox"), $("#allow").modal()) : bowser.msedge ? ($("#browserType").addClass("edge"), $("#browserType").addClass("desktop"), $("#justBrowser").addClass("allow-edge"), $("#allow").modal()) : bowser.msie || (bowser.safari ? bowser.mobile || bowser.tablet : bowser.opera ? bowser.mobile || bowser.tablet || ($("#browserType").addClass("opera"), $("#browserType").addClass("desktop"), $("#justBrowser").addClass("allow-opera"), $("#allow").modal()) : bowser.samsungBrowser && androidPrompt()), function() {
                    if (navigator.userAgent.indexOf("iPhone") > -1 || navigator.userAgent.indexOf("iPad") > -1) var e = {
                        audio: !0,
                        video: {
                            facingMode: {
                                exact: "user"
                            },
                            advanced: [{
                                width: {
                                    min: 400,
                                    max: 1280
                                },
                                height: {
                                    min: 400,
                                    max: 720
                                },
                                frameRate: {
                                    ideal: 15,
                                    max: 22
                                }
                            }]
                        }
                    };
                    else e = 1 == bowser.a && 1 == bowser.android && 1 == bowser.chrome ? {
                        audio: !0,
                        video: {
                            width: {
                                min: 400,
                                max: 1280
                            },
                            height: {
                                min: 400,
                                max: 720
                            },
                            frameRate: {
                                ideal: 15,
                                max: 22
                            }
                        }
                    } : {
                        audio: !0,
                        video: {
                            advanced: [{
                                width: {
                                    min: 400,
                                    max: 1280
                                },
                                height: {
                                    min: 400,
                                    max: 720
                                },
                                frameRate: {
                                    ideal: 15,
                                    max: 22
                                }
                            }]
                        }
                    };
                    navigator.mediaDevices.getUserMedia(e).then((function(e) {
                        document.title = "Joingy! ðŸ’¬", $("#chat").removeClass("header"), $("#chat").addClass("chat-header"), $("#chat").empty();
                        var t = e.getVideoTracks();
                        if (t.length > 0 && (currentVideoDevice = t[0].label), 1 == bowser.android || 1 == bowser.ios ? $("#chat").append('<div id="videocolumn"><div class="vidwrap-stranger"><div id="loading" class="loading"></div><video playsinline id="their-video" muted="true" autoplay></video><div class="watermark"></div><div class="micbtn glyphicon icon-microphone"></div><div class="mutebtn glyphicon glyphicon-volume-up mutebtn-on glyphicon-volume-off"></div></div><div class="vidwrap-user"><video playsinline id="my-video" muted="true" autoplay></video></div></div><div class="chat-padding-video"><div id="chatroom-ctn"><div id="chatroom"></div></div><div id="user-msg-ctn"><div class="user-msg-ctn-btn"><div id="new-btn" role=button class="btn-ctn-new btn" style="margin-left:-119px;"></div><textarea id="user-msg" rows="4" placeholder="Type a message..."></textarea><div id="send-btn" role=button class="btn-ctn btn" style="margin-left:7px;"><div class="positioning">Send</div></div></div></div></div>') : $("#chat").append('<div id="videocolumn"><div class="vidwrap-stranger"><div id="loading" class="loading"></div><video playsinline id="their-video"  autoplay></video><div class="watermark"></div><div class="micbtn glyphicon icon-microphone"></div><div class="mutebtn glyphicon glyphicon-volume-up"></div></div><div class="vidwrap-user"><video playsinline id="my-video" muted="true" autoplay></video></div></div><div class="chat-padding-video"><div id="chatroom-ctn"><div id="chatroom"></div></div><div id="user-msg-ctn"><div class="user-msg-ctn-btn"><div id="new-btn" role=button class="btn-ctn-new btn" style="margin-left:-119px;"></div><textarea id="user-msg" rows="4" placeholder="Type a message..."></textarea><div id="send-btn" role=button class="btn-ctn btn" style="margin-left:7px;"><div class="positioning">Send</div></div></div></div></div>'), $("#my-video").length) {
                            document.getElementById("my-video").oncanplaythrough = function() {
                                setTimeout((() => {
                                    moderationScreenshot("PRECONNECTID")
                                }), 50)
                            };
                            try {
                                $("#my-video").prop("srcObject", e), LocalStream = e
                            } catch (t) {
                                $("#my-video").prop("src", URL.createObjectURL(e)), LocalStream = e
                            }
                        }
                        modInterval = setInterval((() => {
                            moderationScreenshot(currentUID)
                        }), 3e4), $(".micbtn").click((function() {
                            $(this).toggleClass("micbtn-on icon-microphone-slash"), 1 == LocalStream.getAudioTracks()[0].enabled ? LocalStream.getAudioTracks()[0].enabled = !1 : LocalStream.getAudioTracks()[0].enabled = !0
                        })), $(".mutebtn").click((function() {
                            1 == $("#their-video").prop("muted") ? ($("#their-video").prop("muted", !1), $("#their-video").focus()) : ($("#their-video").prop("muted", !0), $("#their-video").focus()), $(this).toggleClass("mutebtn-on glyphicon-volume-off")
                        })), $("#topbar").removeClass("bg-tran"), $("#topbar").addClass("bg-solid"), $("#user-msg").keypress((function(e) {
                            13 == e.which && (dBoop(), e.preventDefault())
                        })), $("#user-msg").blur((function() {
                            $("body").css("position", "relative"), $("body").css("max-height", "none"), bowser.android && $("body").css("padding-bottom", "0px"), clearInterval(_keyboardOn)
                        })), $("#user-msg").focus((function() {
                            if (bowser.android || bowser.ios) {
                                $("body").css("position", "fixed");
                                var e = $(window).innerHeight();
                                $("body").css("max-height", e), bowser.android && $("body").css("padding-bottom", "10px")
                            }
                        })), $(document).keyup((function(e) {
                            27 == e.keyCode && (_rateLimit && _Vid ? ($("#waiting").remove(), testStartVideo()) : _rateLimit && !_Vid ? ($("#waiting").remove(), testStart()) : DiscPre())
                        })), $("#send-btn").on("mousedown", (function(e) {
                            e.preventDefault(), dBoop()
                        })), $("#new-btn").on("mousedown", (function(e) {
                            e.preventDefault(), DiscPre()
                        })), window.chatMode = "video", testStartVideo()
                    })).catch((function(e) {
                        $("#allow").modal("hide"), setInterval((function() {
                            $("#allow").remove()
                        }), 350), bowser.chrome ? bowser.mobile || bowser.tablet ? bowser.ios ? iOSPromptPermissionError() : bowser.android && androidPromptPermissionError() : ($("#browserTypeEnable").addClass("chrome"), $("#browserTypeEnable").addClass("desktop"), $("#enable").modal()) : bowser.firefox ? bowser.mobile || bowser.tablet ? bowser.ios && iOSPrompt() : ($("#browserTypeEnable").addClass("firefox"), $("#browserTypeEnable").addClass("desktop"), $("#enable").modal()) : bowser.msedge ? ($("#browserTypeEnable").addClass("edge"), $("#browserTypeEnable").addClass("desktop"), $("#enablePrompt").replaceWith("<p>Refresh the page and allow your webcam!</p>"), $("#enable").modal()) : bowser.msie || (bowser.safari ? bowser.mobile || bowser.tablet : bowser.opera ? bowser.mobile || bowser.tablet || ($("#browserTypeEnable").addClass("opera"), $("#browserTypeEnable").addClass("desktop"), $("#enable").modal()) : bowser.samsungBrowser || (bowser.ios ? iOSPrompt() : bowser.android ? androidPrompt() : ($("#startvideo").css("background-color", "#AAA"), $("#startvideo").attr("disabled", !0)))), console.error(e)
                    }))
                }()) : triggerShakeEffect()
            }))
        }, n && (!navigator.enumerateDevices && window.MediaStreamTrack && window.MediaStreamTrack.getSources && (navigator.enumerateDevices = window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)), !navigator.enumerateDevices && navigator.enumerateDevices && (navigator.enumerateDevices = navigator.enumerateDevices.bind(navigator)), navigator.enumerateDevices ? (e = [], navigator.enumerateDevices((function(n) {
            n.forEach((function(n) {
                var o, s = {};
                for (var c in n) s[c] = n[c];
                "audio" === s.kind && (s.kind = "audioinput"), "video" === s.kind && (s.kind = "videoinput"), e.forEach((function(e) {
                    e.id === s.id && e.kind === s.kind && (o = !0)
                })), o || (s.deviceId || (s.deviceId = s.id), s.id || (s.id = s.deviceId), s.label ? ("videoinput" !== s.kind || r || (r = !0), "audioinput" !== s.kind || a || (a = !0)) : (s.label = "Please invoke getUserMedia once.", t || (s.label = "HTTPs is required to get label of this " + s.kind + " device.")), "audioinput" === s.kind && !0, "audiooutput" === s.kind && !0, "videoinput" === s.kind && (i = !0), e.push(s))
            })), o && o()
        }))) : o && o())
    })),
    function(e, t, n, o) {
        var i = "lazyLoadXT",
            a = "lazied",
            r = "load error",
            s = "lazy-hidden",
            c = n.documentElement || n.body,
            d = {
                autoInit: !0,
                selector: "img[data-src]",
                blankImage: "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
                throttle: 99,
                forceLoad: t.onscroll === o || !!t.operamini || !c.getBoundingClientRect,
                loadEvent: "pageshow",
                updateEvent: "load orientationchange resize scroll touchmove focus",
                forceEvent: "lazyloadall",
                oninit: {
                    removeClass: "lazy"
                },
                onshow: {
                    addClass: s
                },
                onload: {
                    removeClass: s,
                    addClass: "lazy-loaded"
                },
                onerror: {
                    removeClass: s
                },
                checkDuplicates: !0
            },
            l = {
                srcAttr: "data-src",
                edgeX: 0,
                edgeY: 0,
                visibleOnly: !0
            },
            u = e(t),
            p = e.isFunction,
            f = e.extend,
            m = e.data || function(t, n) {
                return e(t).data(n)
            },
            g = [],
            v = 0,
            h = 0;

        function b(e, t) {
            return e[t] === o ? d[t] : e[t]
        }

        function w() {
            var e = t.pageYOffset;
            return e === o ? c.scrollTop : e
        }

        function y(e, t) {
            var n = d["on" + e];
            n && (p(n) ? n.call(t[0]) : (n.addClass && t.addClass(n.addClass), n.removeClass && t.removeClass(n.removeClass))), t.trigger("lazy" + e, [t]), O()
        }

        function $(t) {
            y(t.type, e(this).off(r, $))
        }

        function S(n) {
            g.length && (n = n || d.forceLoad, v = 1 / 0, g.forEach((function(o, s, d) {
                var l, u, f, g, h, b, S, C, x = o[0],
                    k = o[i],
                    T = !1;
                n || m(x, a);
                e.contains(c, x) ? (n || !k.visibleOnly || x.offsetWidth || x.offsetHeight) && ((l = x, u = k, f = w(), g = t.innerHeight || c.clientHeight, h = t.innerWidth || c.clientWidth, b = l.getBoundingClientRect(), S = u.edgeX, C = u.edgeY, b.top + f - C - g <= f && b.bottom > -C && b.left <= h + S && b.right > -S) ? (! function(e, t) {
                    e.on(r, t), y("show", e);
                    var n = e[0],
                        o = e[i],
                        a = p(o.srcAttr) ? o.srcAttr(e) : n.getAttribute(o.srcAttr);
                    a && (n.src = a)
                }(o, $), T = !0) : v = Math.min(v, function(e, t, n) {
                    var o = e.getBoundingClientRect();
                    return o.top + t - n
                }(x, w(), t.innerHeight || c.clientHeight))) : T = !0;
                T && (m(x, a, 0), d.splice(s--, 1))
            })), 0 === g.length && y("complete", e(c)))
        }
        var C, x, k, T, D = (C = function e() {
            h > 1 ? (h = 1, S(), setTimeout(e, d.throttle)) : h = 0
        }, x = d.throttle, function() {
            var e = this,
                t = arguments,
                n = k && !T;
            clearTimeout(T), T = setTimeout((function() {
                T = null, k || C.apply(e, t)
            }), x), n && C.apply(e, t)
        });

        function O(e) {
            g.length && (e && "scroll" === e.type && e.currentTarget === t && v >= w() || (h || setTimeout(D, 0), h = 2))
        }

        function _() {
            u.lazyLoadXT()
        }

        function P() {
            S(!0)
        }
        e[i] = f(d, l, e[i]), e.fn[i] = function(n) {
            var o, r = b(n = n || {}, "blankImage"),
                s = b(n, "checkDuplicates"),
                c = b(n, "scrollContainer"),
                u = b(n, "show"),
                p = {};
            for (o in e(c).on("scroll", O), l) p[o] = b(n, o);
            return this.each((function(o, c) {
                if (c === t) e(d.selector).lazyLoadXT(n);
                else {
                    var l = s && m(c, a),
                        v = e(c).data(a, u ? -1 : 1);
                    if (l) return void O();
                    r && "IMG" === c.tagName && !c.src && (c.src = r), v[i] = f({}, p), y("init", v), g.push(v), O()
                }
            }))
        }, e(n).ready((function() {
            y("start", u), u.on(d.updateEvent, O).on(d.forceEvent, P), e(n).on(d.updateEvent, O), d.autoInit && (u.on(d.loadEvent, _), _())
        }))
    }(window.jQuery || window.Zepto || window.$, window, document),
    function(e) {
        var t = e.lazyLoadXT,
            n = t.bgAttr || "data-bg";
        t.selector += ",[" + n + "]", e(document).on("lazyshow", (function(t) {
            var o = e(t.target),
                i = o.attr(n);
            i && o.css("background", "linear-gradient( rgba(32, 152, 245, .6), rgba(32, 152, 245, .6), rgba(255, 255, 255, .25)), url('" + i + "') no-repeat center center scroll").css("-webkit-background-size", "cover").css("-moz-background-size:", "cover").css("background-size", "cover").css("-o-background-size", "cover").removeAttr(n).triggerHandler("load")
        }))
    }(window.jQuery || window.Zepto || window.$), $.extend($.lazyLoadXT, {
        edgeY: 300,
        srcAttr: "data-src"
    }),
    function() {
        var e, t, n, o, i, a, r;
        o = function(e, t) {
            var n, o, i;
            for (n in o = [], t.prototype) try {
                i = t.prototype[n], null == e[n] && "function" != typeof i ? o.push(e[n] = i) : o.push(void 0)
            } catch (e) {
                e
            }
            return o
        }, null == (e = {}).options && (e.options = {}), n = {
            checks: {
                xhr: {
                    url: function() {
                        return "https://joingy.com/img/icon/favicon.png?_=" + (new Date).getTime()
                    },
                    timeout: 5e3,
                    type: "HEAD"
                },
                image: {
                    url: function() {
                        return "https://joingy.com/img/icon/favicon.png?_=" + (new Date).getTime()
                    }
                },
                active: "xhr"
            },
            checkOnLoad: !1,
            interceptRequests: !0,
            reconnect: !0,
            deDupBody: !1
        }, i = function(e, t) {
            var n, o, i, a, r;
            for (n = e, o = i = 0, a = (r = t.split(".")).length; a > i && "object" == _typeof(n = n[r[o]]); o = ++i);
            return o === r.length - 1 ? n : void 0
        }, e.getOption = function(t) {
            var o, a;
            return "function" == typeof(a = null != (o = i(e.options, t)) ? o : i(n, t)) ? a() : a
        }, "function" == typeof window.addEventListener && window.addEventListener("online", (function() {
            return setTimeout(e.confirmUp, 100)
        }), !1), "function" == typeof window.addEventListener && window.addEventListener("offline", (function() {
            return e.confirmDown()
        }), !1), e.state = "up", e.markUp = function() {
            return e.trigger("confirmed-up"), "up" !== e.state ? (e.state = "up", e.trigger("up")) : void 0
        }, e.markDown = function() {
            return e.trigger("confirmed-down"), "down" !== e.state ? (e.state = "down", e.trigger("down")) : void 0
        }, a = {}, e.on = function(t, n, o) {
            var i, r, s, c, d;
            if ((r = t.split(" ")).length > 1) {
                for (d = [], s = 0, c = r.length; c > s; s++) i = r[s], d.push(e.on(i, n, o));
                return d
            }
            return null == a[t] && (a[t] = []), a[t].push([o, n])
        }, e.off = function(e, t) {
            var n, o, i;
            if (null != a[e]) {
                if (t) {
                    for (n = 0, i = []; n < a[e].length;)(o = a[e][n])[0], o[1] === t ? i.push(a[e].splice(n, 1)) : i.push(n++);
                    return i
                }
                return a[e] = []
            }
        }, e.trigger = function(e) {
            var t, n, o, i, r, s, c;
            if (null != a[e]) {
                for (c = [], o = 0, i = (r = a[e]).length; i > o; o++) t = (s = r[o])[0], n = s[1], c.push(n.call(t));
                return c
            }
        }, t = function(e, t, n) {
            var o, i, a, r, s;
            return s = function() {
                return e.status && e.status < 12e3 ? t() : n()
            }, null === e.onprogress ? (o = e.onerror, e.onerror = function() {
                return n(), "function" == typeof o ? o.apply(null, arguments) : void 0
            }, r = e.ontimeout, e.ontimeout = function() {
                return n(), "function" == typeof r ? r.apply(null, arguments) : void 0
            }, i = e.onload, e.onload = function() {
                return s(), "function" == typeof i ? i.apply(null, arguments) : void 0
            }) : (a = e.onreadystatechange, e.onreadystatechange = function() {
                return 4 === e.readyState ? s() : 0 === e.readyState && n(), "function" == typeof a ? a.apply(null, arguments) : void 0
            })
        }, e.checks = {}, e.checks.xhr = function() {
            var n;
            (n = new XMLHttpRequest).offline = !1, n.open(e.getOption("checks.xhr.type"), e.getOption("checks.xhr.url"), !0), null != n.timeout && (n.timeout = e.getOption("checks.xhr.timeout")), t(n, e.markUp, e.markDown);
            try {
                n.send()
            } catch (t) {
                t,
                e.markDown()
            }
            return n
        }, e.checks.image = function() {
            var t;
            return (t = document.createElement("img")).onerror = e.markDown, t.onload = e.markUp, void(t.src = e.getOption("checks.image.url"))
        }, e.checks.down = e.markDown, e.checks.up = e.markUp, e.check = function() {
            return e.trigger("checking"), e.checks[e.getOption("checks.active")]()
        }, e.confirmUp = e.confirmDown = e.check, e.onXHR = function(e) {
            var t, n, i;
            return i = function(t, n) {
                var o;
                return o = t.open, t.open = function(i, a, r, s, c) {
                    return e({
                        type: i,
                        url: a,
                        async: r,
                        flags: n,
                        user: s,
                        password: c,
                        xhr: t
                    }), o.apply(t, arguments)
                }
            }, n = window.XMLHttpRequest, window.XMLHttpRequest = function(e) {
                var t, o, a;
                return a = new n(e), i(a, e), o = a.setRequestHeader, a.headers = {}, a.setRequestHeader = function(e, t) {
                    return a.headers[e] = t, o.call(a, e, t)
                }, t = a.overrideMimeType, a.overrideMimeType = function(e) {
                    return a.mimeType = e, t.call(a, e)
                }, a
            }, o(window.XMLHttpRequest, n), null != window.XDomainRequest ? (t = window.XDomainRequest, window.XDomainRequest = function() {
                var e;
                return e = new t, i(e), e
            }, o(window.XDomainRequest, t)) : void 0
        }, r = function() {
            return e.getOption("interceptRequests") && e.onXHR((function(n) {
                var o;
                return !1 !== (o = n.xhr).offline ? t(o, e.markUp, e.confirmDown) : void 0
            })), e.getOption("checkOnLoad") ? e.check() : void 0
        }, setTimeout(r, 0), window.Offline = e
    }.call(void 0),
    function() {
        var e, t, n, o, i, a, r, s, c;
        if (!window.Offline) throw new Error("Offline Reconnect brought in without offline.js");
        o = Offline.reconnect = {}, a = null, i = function() {
            var e;
            return null != o.state && "inactive" !== o.state && Offline.trigger("reconnect:stopped"), o.state = "inactive", o.remaining = o.delay = null != (e = Offline.getOption("reconnect.initialDelay")) ? e : 3
        }, t = function() {
            var e, t;
            return e = null != (t = Offline.getOption("reconnect.delay")) ? t : Math.min(Math.ceil(1.5 * o.delay), 3600), o.remaining = o.delay = e
        }, r = function() {
            return "connecting" !== o.state ? (o.remaining -= 1, Offline.trigger("reconnect:tick"), 0 === o.remaining ? s() : void 0) : void 0
        }, s = function() {
            return "waiting" === o.state ? (Offline.trigger("reconnect:connecting"), o.state = "connecting", Offline.check()) : void 0
        }, e = function() {
            return Offline.getOption("reconnect") ? (i(), o.state = "waiting", Offline.trigger("reconnect:started"), a = setInterval(r, 1e3)) : void 0
        }, c = function() {
            return null != a && clearInterval(a), i()
        }, n = function() {
            return Offline.getOption("reconnect") && "connecting" === o.state ? (Offline.trigger("reconnect:failure"), o.state = "waiting", t()) : void 0
        }, o.tryNow = s, i(), Offline.on("down", e), Offline.on("confirmed-down", n), Offline.on("up", c)
    }.call(void 0),
    function() {
        var e, t, n, o, i, a;
        if (!window.Offline) throw new Error("Requests module brought in without offline.js");
        n = [], a = !1, o = function(e) {
            return !1 !== Offline.getOption("requests") ? (Offline.trigger("requests:capture"), "down" !== Offline.state && (a = !0), n.push(e)) : void 0
        }, i = function(e) {
            var t, n, o, i, a, r, s, c, d;
            if (d = e.xhr, r = e.url, a = e.type, s = e.user, o = e.password, t = e.body, !1 !== Offline.getOption("requests")) {
                for (n in d.abort(), d.open(a, r, !0, s, o), i = d.headers, i) c = i[n], d.setRequestHeader(n, c);
                return d.mimeType && d.overrideMimeType(d.mimeType), d.send(t)
            }
        }, e = function() {
            return n = []
        }, t = function() {
            var t, o, a, r, s, c, d;
            if (!1 !== Offline.getOption("requests")) {
                for (Offline.trigger("requests:flush"), c = {}, o = 0, r = n.length; r > o; o++) d = (s = n[o]).url.replace(/(\?|&)_=[0-9]+/, (function(e, t) {
                    return "?" === t ? t : ""
                })), Offline.getOption("deDupBody") ? (t = s.body, t = "[object Object]" === t.toString() ? JSON.stringify(t) : t.toString(), c[s.type.toUpperCase() + " - " + d + " - " + t] = s) : c[s.type.toUpperCase() + " - " + d] = s;
                for (a in c) s = c[a], i(s);
                return e()
            }
        }, setTimeout((function() {
            return !1 !== Offline.getOption("requests") ? (Offline.on("confirmed-up", (function() {
                return a ? (a = !1, e()) : void 0
            })), Offline.on("up", t), Offline.on("down", (function() {
                return a = !1
            })), Offline.onXHR((function(e) {
                var t, n, i, a, r;
                return r = e.xhr, i = e.async, !1 !== r.offline && (a = function() {
                    return o(e)
                }, n = r.send, r.send = function(t) {
                    return e.body = t, n.apply(r, arguments)
                }, i) ? null === r.onprogress ? (r.addEventListener("error", a, !1), r.addEventListener("timeout", a, !1)) : (t = r.onreadystatechange, r.onreadystatechange = function() {
                    return (0 === r.readyState || 4 === r.readyState && (0 === r.status || r.status >= 12e3)) && a(), "function" == typeof t ? t.apply(null, arguments) : void 0
                }) : void 0
            })), Offline.requests = {
                flush: t,
                clear: e
            }) : void 0
        }), 0)
    }.call(void 0),
    function() {
        var e, t, n, o, i;
        if (!Offline) throw new Error("Offline simulate brought in without offline.js");
        for (t = 0, n = (o = ["up", "down"]).length; n > t; t++) i = o[t], (document.querySelector("script[data-simulate='" + i + "']") || ("undefined" != typeof localStorage && null !== localStorage ? localStorage.OFFLINE_SIMULATE : void 0) === i) && (null == Offline.options && (Offline.options = {}), null == (e = Offline.options).checks && (e.checks = {}), Offline.options.checks.active = i)
    }.call(void 0),
    function() {
        var e, t, n, o, i, a, r, s, c, d, l;
        if (!window.Offline) throw new Error("Offline UI brought in without offline.js");
        o = function(e) {
            var t;
            return (t = document.createElement("div")).innerHTML = e, t.children[0]
        }, i = n = null, t = function(e) {
            return c(e), i.className += " " + e
        }, c = function(e) {
            return i.className = i.className.replace(new RegExp("(^| )" + e.split(" ").join("|") + "( |$)", "gi"), " ")
        }, r = {}, a = function(e, n) {
            return t(e), null != r[e] && clearTimeout(r[e]), r[e] = setTimeout((function() {
                return c(e), delete r[e]
            }), 1e3 * n)
        }, l = function(e) {
            var t, n, o;
            for (n in o = {
                    day: 86400,
                    hour: 3600,
                    minute: 60,
                    second: 1
                })
                if (e >= (t = o[n])) return [Math.floor(e / t), n];
            return ["now", ""]
        }, d = function() {
            var e, a;
            return i = o('<div class="offline-ui"><div class="offline-ui-content"></div></div>'), document.body.appendChild(i), null != Offline.reconnect && Offline.getOption("reconnect") && (i.appendChild(o('<a href class="offline-ui-retry"></a>')), a = function(e) {
                return e.preventDefault(), Offline.reconnect.tryNow()
            }, null != (e = i.querySelector(".offline-ui-retry")).addEventListener ? e.addEventListener("click", a, !1) : e.attachEvent("click", a)), t("offline-ui-" + Offline.state), n = i.querySelector(".offline-ui-content")
        }, s = function() {
            return d(), Offline.on("up", (function() {
                return c("offline-ui-down"), t("offline-ui-up"), a("offline-ui-up-2s", 2), a("offline-ui-up-5s", 5)
            })), Offline.on("down", (function() {
                return c("offline-ui-up"), t("offline-ui-down"), a("offline-ui-down-2s", 2), a("offline-ui-down-5s", 5)
            })), Offline.on("reconnect:connecting", (function() {
                return t("offline-ui-connecting"), c("offline-ui-waiting")
            })), Offline.on("reconnect:tick", (function() {
                var e, o, i;
                return t("offline-ui-waiting"), c("offline-ui-connecting"), o = (e = l(Offline.reconnect.remaining))[0], i = e[1], n.setAttribute("data-retry-in-value", o), n.setAttribute("data-retry-in-unit", i)
            })), Offline.on("reconnect:stopped", (function() {
                return c("offline-ui-connecting offline-ui-waiting"), n.setAttribute("data-retry-in-value", null), n.setAttribute("data-retry-in-unit", null)
            })), Offline.on("reconnect:failure", (function() {
                return a("offline-ui-reconnect-failed-2s", 2), a("offline-ui-reconnect-failed-5s", 5)
            })), Offline.on("reconnect:success", (function() {
                return a("offline-ui-reconnect-succeeded-2s", 2), a("offline-ui-reconnect-succeeded-5s", 5)
            }))
        }, "complete" === document.readyState ? s() : null != document.addEventListener ? document.addEventListener("DOMContentLoaded", s, !1) : (e = document.onreadystatechange, document.onreadystatechange = function() {
            return "complete" === document.readyState && s(), "function" == typeof e ? e.apply(null, arguments) : void 0
        })
    }.call(void 0);